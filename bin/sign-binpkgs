#!/bin/sh

# Sign void packages

REPO="${HOME}/repos/void/void-packages"
KEY="${$REPO/.privkey.pem=-$HOME/.ssh/privkey.pem}"
BINPKGS="${REPO}/hostdir/binpkgs/*.xbps"
export XBPS_PASSPHRASE="foobar"


# Initialize new key for repository metadata

newkey(){
	xbps-rindex --sign --signedby "wandsas" --privkey ${KEY} ${BINPKGS}
}


# Make a signature per package

xbps-rindex --sign-pkg --privkey ${KEY} ${BINPKGS}


# Verify signed pkgs

xbps-query --repository=${REPO}/hostdir/binpkgs -vL

# vim: fenc=utf-8 ft=sh ts=2 sts=2 sw=2 et
